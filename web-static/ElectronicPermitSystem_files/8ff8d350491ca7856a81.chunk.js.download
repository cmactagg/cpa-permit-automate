(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1022:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(1),i=I(o),r=n(98),l=n(7),s=I(l),c=n(6),u=I(c),d=n(29),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(d),p=n(15),h=I(p),g=n(136),b=I(g),m=n(1071),v=I(m),_=n(1060),y=I(_),k=n(351);function I(e){return e&&e.__esModule?e:{default:e}}var M=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={readyForAuth:!1,currentMode:void 0},e._bind("getToken","checkForError"),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidUpdate",value:function(){this.checkForError()}},{key:"componentDidMount",value:function(){var e=sessionStorage.getItem("currentMode");s.default.isUndefined(e)||(this.setState({readyForAuth:!0,currentMode:window.atob(e)}),this.checkForError())}},{key:"checkForError",value:function(){var e=this,t=localStorage.getItem("error");s.default.isUndefined(t)?f.cleanLocalStorage():f.cleanLocalStorage().then(function(){"401"===t&&e._errorMessage("unauthorizedErrorTitle","unauthorizedErrorMessage"),"403"===t&&e._errorMessage("unauthorizedErrorTitle","unauthorizedErrorMessage")})}},{key:"getToken",value:function(){var e=window.location.hash.substr(1);return e.substr(e.indexOf("access_token=")).split("=")[1]}},{key:"render",value:function(){var e=this.getToken();return i.default.createElement("div",{className:"container-fluid"},i.default.createElement("div",{className:"jumbotron"},s.default.isUndefined(e)&&i.default.createElement("div",null,i.default.createElement("h2",{className:"text-center"},h.default.t("app_title")),i.default.createElement("img",{className:"img-responsive center-block",id:"loginLogo",alt:"logo",src:window.logo}),this.state.currentMode!==k.appModes.off&&this.state.currentMode!==k.appModes.down&&i.default.createElement("div",{className:"text-center"},i.default.createElement(b.default,{id:"welcomeMessage",translationVar:"welcome_message"})),this.state.currentMode===k.appModes.off&&i.default.createElement("div",{className:"text-center"},i.default.createElement("h1",null,h.default.t("coming_soon"))),this.state.currentMode===k.appModes.down&&i.default.createElement("div",{className:"text-center"},i.default.createElement("h1",null,h.default.t("down_for_maintenance")))),i.default.createElement("div",{className:"text-center"},this.state.readyForAuth&&i.default.createElement(v.default,{token:e,itaId:this.props.match.params.id,mode:this.state.currentMode}))),s.default.has(this.props.match,"params")&&!s.default.isUndefined(this.props.match.params.id)&&s.default.isUndefined(e)&&i.default.createElement(y.default,{itaId:this.props.match.params.id,loggedIn:!s.default.isUndefined(e)}))}}]),t}(u.default);t.default=(0,r.withNotifications)(M)},1060:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(1),i=_(o),r=n(0),l=_(r),s=n(7),c=_(s),u=n(98),d=n(6),f=_(d),p=n(15),h=_(p),g=n(873),b=_(g),m=n(1054),v=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(m);function _(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._bind("validateInvitation","closeBasicModal","basicModalCallback","acceptBtnClicked","rejectBtnClicked","buildAcceptRejectModalBody"),e.state={itaId:"",itaInfoModal:"",basicModalIsOpen:!1,acceptRejectModalIsOpen:!1},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){c.default.isUndefined(this.props.itaId)||this.props.loggedIn||this.validateInvitation(this.props.itaId),this.props.loggedIn&&this.setState({acceptRejectModalIsOpen:!0,basicModalIsOpen:!1})}},{key:"componentWillReceiveProps",value:function(e){c.default.has(e,"loggedIn")&&e.loggedIn&&this.setState({acceptRejectModalIsOpen:!0,basicModalIsOpen:!1})}},{key:"basicModalCallback",value:function(){this.setState({basicModalIsOpen:!1})}},{key:"closeBasicModal",value:function(){this.setState({basicModalIsOpen:!1})}},{key:"validateInvitation",value:function(e){var t=this;v.validateIta(e).then(function(){var n=h.default.t("ita_activation_message");t.setState({itaInfoModal:n,basicModalIsOpen:!0,itaId:e})},function(){var e=h.default.t("error_invalid_ita_expired");t.setState({itaInfoModal:e,basicModalIsOpen:!0})})}},{key:"acceptBtnClicked",value:function(){var e=this;this.props.loggedIn&&v.acceptIta(this.props.itaId).then(function(t){c.default.isUndefined(t)||c.default.isUndefined(t.roles)||c.default.isUndefined(t.rtoken)||(localStorage.setItem("roles",window.btoa(JSON.stringify(t.roles))),localStorage.setItem("rtoken",t.rtoken)),e.props.finishedCallback()},function(){e.setState({acceptRejectModalIsOpen:!1}),e._errorMessage("error_invalid_ita_email_not_match_lbl","error_invalid_ita_email_not_match"),e.props.finishedCallback()})}},{key:"rejectBtnClicked",value:function(){var e=this;this.props.loggedIn&&v.rejectIta(this.props.itaId).then(function(){e.props.finishedCallback()},function(){e.setState({acceptRejectModalIsOpen:!1}),e._errorMessage("error_invalid_ita_email_not_match_lbl","error_invalid_ita_email_not_match"),e.props.finishedCallback()})}},{key:"buildAcceptRejectModalBody",value:function(){}},{key:"render",value:function(){var e=h.default.t("ita_activation_confirmation");return i.default.createElement("div",null,i.default.createElement(b.default,{title:h.default.t("ita_activation_title"),body:this.state.itaInfoModal,modalId:"loginRequiredItaModal",isOpen:this.state.basicModalIsOpen,okClick:this.basicModalCallback,closeClick:this.closeBasicModal,isQuestion:!1,hideClose:!0}),i.default.createElement(b.default,{title:h.default.t("ita_activation_title"),body:e,modalId:"acceptRejectItaModal",isOpen:this.state.acceptRejectModalIsOpen,okClick:this.acceptBtnClicked,closeClick:this.rejectBtnClicked,isQuestion:!0}))}}]),t}(f.default);y.propTypes={itaId:l.default.string,loggedIn:l.default.bool,finishedCallback:l.default.func},t.default=(0,u.withNotifications)(y)},1071:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(1),i=U(o),r=n(0),l=U(r),s=n(49),c=n(7),u=U(c),d=n(64),f=U(d),p=n(6),h=U(p),g=n(99),b=C(g),m=n(29),v=C(m),_=n(1053),y=C(_),k=n(15),I=U(k),M=n(201),w=U(M),O=n(1060),E=U(O),j=n(343),S=n(351);function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function U(e){return e&&e.__esModule?e:{default:e}}var P=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._bind("generateRedirectUrl","loginCall","stopSpinner","forwardToNextPage"),e.state={loggedIn:!1,loading:!1,loginUrl:""},e.spinner=i.default.createRef(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentWillMount",value:function(){var e=this;b.getLoginUrl().then(function(t){e.setState({loginUrl:t.loginUrl})},function(){})}},{key:"componentWillReceiveProps",value:function(e){u.default.isUndefined(e.token)&&this.stopSpinner()}},{key:"componentDidMount",value:function(){this.loginCall()}},{key:"stopSpinner",value:function(){u.default.isNil(this.spinner.current)||this.setState({loggedIn:!1,loading:!1})}},{key:"forwardToNextPage",value:function(){v.checkModule(j.modules.rpp)?this.props.history.push(j.defaultUrls[j.modules.rpp].user):v.checkModule(j.modules.cp)&&this.props.history.push(j.defaultUrls[j.modules.cp].user)}},{key:"loginCall",value:function(){var e=this;if(u.default.isNil(this.props.token)||0===this.props.token.length)this.stopSpinner();else{this.setState({loading:!0,userEmail:"user.email"});var t=this.props.token.split("&")[0];b.login(t).then(function(t){localStorage.setItem("roles",window.btoa(JSON.stringify(t.roles))),localStorage.setItem("rtoken",t.rtoken),f.default.all([b.getEnabledModules(),y.getClientContractConfig()]).spread(function(t,n){var a=u.default.filter(t,function(e){return e.appEnabled});localStorage.setItem("mods",window.btoa(JSON.stringify(a))),sessionStorage.setItem("membership",window.btoa(n)),e.setState({loading:!1,loggedIn:!0}),u.default.isUndefined(e.props.itaId)&&e.forwardToNextPage()},function(e){console.log(e)})},function(){e.stopSpinner()})}}},{key:"generateRedirectUrl",value:function(){var e=window.location.href.split("/"),t=e[0],n=e[2],a=t+"//"+n;return u.default.isUndefined(this.props.itaId)||(a+="//activate-ita//"+this.props.itaId),a}},{key:"render",value:function(){return i.default.createElement("div",{className:"container-fluid"},i.default.createElement("div",{ref:this.spinner},i.default.createElement(w.default,{visible:this.state.loading,fullScreen:!0})),u.default.isUndefined(this.props.token)&&this.props.mode!==S.appModes.off&&this.props.mode!==S.appModes.down&&i.default.createElement("a",{href:this.state.loginUrl+this.generateRedirectUrl(),className:"btn btn-lg btn-primary"},I.default.t("login_button")),!u.default.isUndefined(this.props.itaId)&&this.state.loggedIn&&i.default.createElement(E.default,{itaId:this.props.itaId,loggedIn:this.state.loggedIn,finishedCallback:this.forwardToNextPage}))}}]),t}(h.default);P.PropTypes={token:l.default.string,itaId:l.default.string,mode:l.default.string},t.default=(0,s.withRouter)(P)}}]);